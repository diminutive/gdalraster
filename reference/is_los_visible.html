<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check line of sight between pairs of point locations — is_los_visible • gdalraster</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check line of sight between pairs of point locations — is_los_visible"><meta name="description" content="is_los_visible() is an interface to GDAL's line-of-sight algorithm
implemented by GDALIsLineOfSightVisible() in the Algorithms C API
(https://gdal.org/en/stable/api/gdal_alg.html). It checks line of sight
across a DEM surface using a Bresenham algorithm. The function can operate
pairwise on sets of input points, or one-to-many. Requires GDAL &amp;gt;= 3.9."><meta property="og:description" content="is_los_visible() is an interface to GDAL's line-of-sight algorithm
implemented by GDALIsLineOfSightVisible() in the Algorithms C API
(https://gdal.org/en/stable/api/gdal_alg.html). It checks line of sight
across a DEM surface using a Bresenham algorithm. The function can operate
pairwise on sets of input points, or one-to-many. Requires GDAL &amp;gt;= 3.9."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdalraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0.9078</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/raster-api-tutorial.html">Raster API Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/raster-display.html">Raster Display</a></li>
    <li><a class="dropdown-item" href="../articles/raster-attribute-tables.html">Raster Attribute Tables</a></li>
    <li><a class="dropdown-item" href="../articles/gdal-block-cache.html">GDAL Block Cache</a></li>
    <li><a class="dropdown-item" href="../articles/vector-api-overview.html">Vector API Overview</a></li>
    <li><a class="dropdown-item" href="../articles/vector-read-benchmarks.html">Vector Read Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/gdal-config-quick-ref.html">GDAL Config Quick Reference</a></li>
    <li><a class="dropdown-item" href="../articles/use-gdal-cli-from-r.html">Using 'gdal' CLI algorithms from R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Archived articles</h6></li>
    <li><a class="dropdown-item" href="../articles/gdalvector-draft.html">Draft Bindings to the GDAL/OGR Vector API</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/firelab/gdalraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Check line of sight between pairs of point locations</h1>
      <small class="dont-index">Source: <a href="https://github.com/firelab/gdalraster/blob/main/R/gdalraster_proc.R" class="external-link"><code>R/gdalraster_proc.R</code></a></small>
      <div class="d-none name"><code>is_los_visible.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>is_los_visible()</code> is an interface to GDAL's line-of-sight algorithm
implemented by <code>GDALIsLineOfSightVisible()</code> in the Algorithms C API
(<a href="https://gdal.org/en/stable/api/gdal_alg.html" class="external-link">https://gdal.org/en/stable/api/gdal_alg.html</a>). It checks line of sight
across a DEM surface using a Bresenham algorithm. The function can operate
pairwise on sets of input points, or one-to-many. Requires GDAL &gt;= 3.9.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">is_los_visible</span><span class="op">(</span></span>
<span>  <span class="va">dem</span>,</span>
<span>  <span class="va">ptsA</span>,</span>
<span>  <span class="va">ptsB</span>,</span>
<span>  band <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  srsA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  srsB <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ZinterpA <span class="op">=</span> <span class="st">"RELATIVE_TO_DEM"</span>,</span>
<span>  ZinterpB <span class="op">=</span> <span class="st">"RELATIVE_TO_DEM"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dem">dem<a class="anchor" aria-label="anchor" href="#arg-dem"></a></dt>
<dd><p>Either a character string giving the filename of the DEM
raster, or an object of class <code>GDALRaster</code> for the DEM.</p></dd>


<dt id="arg-ptsa">ptsA<a class="anchor" aria-label="anchor" href="#arg-ptsa"></a></dt>
<dd><p>A data frame or numeric matrix containing geospatial point
coordinates, or point geometries (with Z values) as a list of WKB raw vectors
or character vector of WKT strings. If data frame or matrix, the number of
columns must be three (x, y, z). May be also be given as a numeric vector for
one point (<code>c(x, y, z)</code>). If this argument contains a single point, then
line of sight will be checked between it and each point in <code>ptsB</code>, otherwise
<code>length(ptsA)</code> must equal <code>length(ptsB)</code>, and line of sight will be checked
pairwise.</p></dd>


<dt id="arg-ptsb">ptsB<a class="anchor" aria-label="anchor" href="#arg-ptsb"></a></dt>
<dd><p>The second set of points, as described above for <code>ptsA</code>.</p></dd>


<dt id="arg-band">band<a class="anchor" aria-label="anchor" href="#arg-band"></a></dt>
<dd><p>An integer value specifying the band number in <code>dem</code> to use.
Defaults to <code>1L</code>.</p></dd>


<dt id="arg-srsa">srsA<a class="anchor" aria-label="anchor" href="#arg-srsa"></a></dt>
<dd><p>An optional character string specifying the spatial reference
system for <code>ptsA</code>. May be in WKT format or any of the formats supported by
<code><a href="srs_convert.html">srs_to_wkt()</a></code>. If this argument is <code>NULL</code> (the default), then <code>ptsA</code> are
assumed to be in the same coordinate reference system as <code>dem</code>. Otherwise,
<code>ptsA</code> will be reprojected from <code>srsA</code> to the spatial reference of <code>dem</code>.</p></dd>


<dt id="arg-srsb">srsB<a class="anchor" aria-label="anchor" href="#arg-srsb"></a></dt>
<dd><p>An optional character string specifying the spatial reference
system for <code>ptsB</code> (see above). Defaults to <code>NULL</code>. If not <code>NULL</code>, <code>ptsB</code> will
be reprojected from <code>srsB</code> to the spatial reference of <code>dem</code>.</p></dd>


<dt id="arg-zinterpa">ZinterpA<a class="anchor" aria-label="anchor" href="#arg-zinterpa"></a></dt>
<dd><p>A character string specifying the interpretation of the Z
values for <code>ptsA</code>. The default is <code>"RELATIVE_TO_DEM"</code>, in which case the
location heights of <code>ptsA</code> are obtained by querying the DEM surface and
adding the Z value given in <code>ptsA</code>. Alternatively, the Z values can be
interpreted as absolute heights to be used unmodified by setting this
argument to <code>"ACTUAL"</code>.</p></dd>


<dt id="arg-zinterpb">ZinterpB<a class="anchor" aria-label="anchor" href="#arg-zinterpb"></a></dt>
<dd><p>A character string specifying the interpretation of the Z
values for <code>ptsB</code>. See the description above for <code>ZinterpA</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>A logical value with default of <code>FALSE</code>. If set to <code>TRUE</code>, will
suppress a progress bar and informational messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A logical vector of <code>length(ptsB)</code>, <code>TRUE</code> for each pair of points
that are within line of sight, otherwise <code>FALSE</code>.
The checks are done pairwise if <code>(length(ptsA) == length(ptsB))</code>, or
one-to-many if <code>length(ptsA) == 1</code> and multiple points are given in <code>ptsB</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Input coordinates must be within the raster bounds. <code>NA</code> will be returned if
either coordinate is outside the raster extent, or is missing a Z value.</p>
<p>The GDAL documentation notes that line of sight is computed in raster
coordinate space, and thus may not be appropriate for some applications. For
example, datasets referenced against geographic coordinates at high latitudes
may have issues.</p>
<p>At the time of writing (GDAL 3.9 through 3.12.1), a point exactly on the
surface of the DEM is never visible with <code>GDALIsLineOfSightVisible()</code>, even
if viewed from a point directly above. For a detailed description, see
<a href="https://github.com/OSGeo/gdal/issues/12458" class="external-link">https://github.com/OSGeo/gdal/issues/12458</a>. A workaround for that case
could be to set a small but negligible postive Z value (if using
<code>"RELATIVE_TO_DEM"</code>) for points that are intended to be on the DEM surface,
if appropriate for the use case.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://www.researchgate.net/publication/2411280_Efficient_Line-of-Sight_Algorithms_for_Real_Terrain_Data" class="external-link">https://www.researchgate.net/publication/2411280_Efficient_Line-of-Sight_Algorithms_for_Real_Terrain_Data</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># gdal_version_num() &gt;= gdal_compute_version(3, 9, 0)</span></span></span>
<span class="r-in"><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/storml_elev.tif"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## no reprojection, the point coordinates are in the same projection as DEM</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## one-to-many</span></span></span>
<span class="r-in"><span><span class="va">ptA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">324625.0</span>, <span class="fl">5104724.0</span>, <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ptsB</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">324803.0</span>, <span class="fl">5104517.0</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>         <span class="fl">325286.0</span>, <span class="fl">5102923.0</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>         <span class="fl">323847.0</span>, <span class="fl">5104538.0</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ptsB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ptsB</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is_los_visible</span><span class="op">(</span><span class="va">dem</span>, <span class="va">ptA</span>, <span class="va">ptsB</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## pairwise, same ptA location with varying height</span></span></span>
<span class="r-in"><span><span class="va">ptsA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">324625.0</span>, <span class="fl">5104724.0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>          <span class="fl">324625.0</span>, <span class="fl">5104724.0</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>          <span class="fl">324625.0</span>, <span class="fl">5104724.0</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ptsA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ptsA</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is_los_visible</span><span class="op">(</span><span class="va">dem</span>, <span class="va">ptsA</span>, <span class="va">ptsB</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## WKB points</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ptsA_wkb</span> <span class="op">&lt;-</span> <span class="fu"><a href="g_factory.html">g_create</a></span><span class="op">(</span><span class="st">"POINT"</span>, <span class="va">ptsA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># as WKT</span></span></span>
<span class="r-in"><span><span class="fu"><a href="g_wk2wk.html">g_wk2wk</a></span><span class="op">(</span><span class="va">ptsA_wkb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or as ISO WKT</span></span></span>
<span class="r-in"><span><span class="fu"><a href="g_wk2wk.html">g_wk2wk</a></span><span class="op">(</span><span class="va">ptsA_wkb</span>, as_iso <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is_los_visible</span><span class="op">(</span><span class="va">dem</span>, <span class="va">ptsA_wkb</span>, <span class="va">ptsB</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## reprojecting ptsA, and the DEM given as a dataset object</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALRaster</span>, <span class="va">dem</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ptsA_wkb_wgs84</span> <span class="op">&lt;-</span> <span class="fu"><a href="g_transform.html">g_transform</a></span><span class="op">(</span><span class="va">ptsA_wkb</span>, <span class="va">ds</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span>, <span class="st">"WGS84"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="g_wk2wk.html">g_wk2wk</a></span><span class="op">(</span><span class="va">ptsA_wkb_wgs84</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is_los_visible</span><span class="op">(</span><span class="va">ds</span>, <span class="va">ptsA_wkb_wgs84</span>, <span class="va">ptsB</span>, srsA <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## read ptsB from a vector dataset, use original ptA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/storml_los_pts_b.geojson"</span>, package<span class="op">=</span><span class="st">"gdalraster"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">lyr</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">GDALVector</span>, <span class="va">dsn</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">features</span> <span class="op">&lt;-</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">fetch</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is_los_visible</span><span class="op">(</span><span class="va">ds</span>, <span class="va">ptA</span>, <span class="va">features</span><span class="op">$</span><span class="va">geom</span>, srsB <span class="op">=</span> <span class="va">lyr</span><span class="op">$</span><span class="fu">getSpatialRef</span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               ZinterpB <span class="op">=</span> <span class="st">"ACTUAL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ds</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lyr</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Toney, Michael D. Sumner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

